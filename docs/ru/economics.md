# Экономическая модель и токеномика

ComputeChain использует тщательно разработанную экономическую модель, которая балансирует безопасность, децентрализацию и устойчивость.

## Обзор

**Токен:** CPC (ComputeChain Coin)
**Decimals:** 18
**Genesis Supply:** 1,000,000,000 CPC (devnet)
**Максимальное предложение:** Бесконечное (с халвингом)
**Консенсус:** Multi-validator PoA (переход к PoC)

---

## Модель эмиссии

### Награды за блоки

ComputeChain использует **модель эмиссии с халвингом**, похожую на Bitcoin:

```
Начальная награда за блок: 10 CPC
Период халвинга: Каждые 1,000,000 блоков
Формула: reward = initial_reward >> halvings
```

**График инфляции (Devnet @ 10s время блока):**

| Период | Блоки | Награда за блок | Годовая инфляция |
|--------|--------|-----------------|-------------------|
| Год 1 | 0 - 999,999 | 10 CPC | ~3.15% |
| Год 2+ | 1M - 1.99M | 5 CPC | ~1.58% |
| Год 4+ | 2M - 2.99M | 2.5 CPC | ~0.79% |
| ... | ... | ... | Уменьшается |

**Общее предложение (асимптотическое):**
- Genesis: 1,000,000,000 CPC
- Всего отчеканено со временем: ~42M CPC (асимптотически)
- Максимальное теоретическое предложение: ~1,042,000,000 CPC

---

## Распределение наград за блоки

Награда за каждый блок делится между различными участниками сети:

```
Награда за блок: 10 CPC (начальная)
├─ 70% (7 CPC)   → Пул валидаторов
└─ 30% (3 CPC)   → Пул майнеров (PoC Workers)
```

### Пул валидаторов (70%)

Распределяется производителю блока (валидатору, создавшему блок).

**Если у валидатора есть делегации:**
- **Комиссия:** Валидатор берёт комиссию % (макс. 20%)
- **Награды делегаторов:** Оставшаяся сумма распределяется пропорционально делегаторам
- **Пыль:** Любой остаток от целочисленного деления **сжигается**

**Если нет делегаций:**
- Валидатор получает весь пул

**Пример:**
```
Награда за блок: 10 CPC
Пул валидатора: 7 CPC
Комиссия валидатора: 10%

Комиссия: 0.7 CPC → Валидатору
Пул делегаторов: 6.3 CPC → Распределяется пропорционально
```

### Пул майнеров (30%)

Распределяется PoC (Proof-of-Compute) воркерам, отправляющим валидные результаты вычислений.

**Распределение:**
- Пропорционально **весу майнера**
- Вес вычисляется off-chain: `weight = results * gpu_tier * uptime * difficulty * reputation`
- Верифицируется on-chain через **ZK доказательство**

**Статус:** Инфраструктура готова, ожидается реализация PoC в Фазе 2A.
До тех пор неиспользованный пул майнеров **сжигается**.

---

## Комиссии за транзакции

Комиссии за транзакции распределяются следующим образом:

```
Общие комиссии = gas_used * gas_price

├─ 90% → Производителю блока (Валидатору)
├─ 10% → Казначейству (Community Pool)
└─ Пыль → Сжигается
```

**Структура комиссий:**

| Тип транзакции | Базовая стоимость Gas |
|----------------|------------------------|
| TRANSFER | 21,000 |
| STAKE | 40,000 |
| UNSTAKE | 40,000 |
| DELEGATE | 35,000 |
| UNDELEGATE | 35,000 |
| UNJAIL | 50,000 |
| UPDATE_VALIDATOR | 30,000 |
| SUBMIT_RESULT (PoC) | 80,000 |

---

## Механизмы сжигания

ComputeChain реализует **выборочное сжигание** - токены сжигаются только когда это действительно необходимо:

### Что сжигается

1. **Штрафы за слешинг**
   - Нарушение валидатором: 5% от общего стейка (self + делегации)
   - Неверные результаты майнера: 10% от стейка воркера
   - Все заслешенные токены → **СЖИГАЮТСЯ**

2. **Комиссия за выход из тюрьмы**
   - Досрочный выход из jail: 1,000 CPC → **СЖИГАЕТСЯ**

3. **Штраф за анстейкинг (если в тюрьме)**
   - 10% от self_stake → **СЖИГАЕТСЯ**

4. **Пыль от целочисленного деления**
   - Остаток от распределения наград → **СЖИГАЕТСЯ**

5. **Неиспользованный пул майнеров**
   - Если нет PoC активности в блоке → **СЖИГАЕТСЯ** (до Фазы 2A)

6. **Превышение лимитов валидатора/майнера**
   - Если награда превышает лимиты → **СЖИГАЕТСЯ**

### Годовая оценка сжигания

**Devnet (лучший случай):**
- Сжигание комиссий (20%): ~630k CPC/год
- Пыль: ~50k CPC/год
- Неиспользованный пул майнеров: ~9.5M CPC/год (до активации PoC)
- **Всего: ~10M CPC/год**

**Чистая эмиссия (Фаза 1):**
- Отчеканено: ~31.5M CPC/год
- Сожжено: ~10M CPC/год
- **Чистая: ~21.5M CPC/год** (~2.15% инфляция)

---

## Стейкинг и делегирование

### Стейкинг валидаторов

**Минимальный стейк:**
- Devnet: 1,000 CPC
- Mainnet: 100,000 CPC

**Анстейкинг:**
- **Период разблокировки:** 100 блоков (devnet) / 21 день (mainnet)
- **Штраф если в тюрьме:** 10% стейка сжигается
- **Автоматический возврат:** Токены возвращаются после периода разблокировки

### Делегирование

**Минимальное делегирование:** 100 CPC

**Лимиты:**
- **Макс. валидаторов на делегатора:** 10
- **Макс. мощность валидатора:** 20% от общей voting power

**Разблокировка:**
- **Период:** Такой же как у валидаторов (21 день mainnet)
- **Без штрафа:** Делегаторы не штрафуются за отзыв делегирования
- **Риск слешинга:** Если валидатор заслешен, делегаторы тоже теряют 5%

**Как это работает:**
1. Делегируете токены валидатору
2. Валидатор зарабатывает награды за блоки
3. Вычитается комиссия (например, 10%)
4. Оставшиеся награды распределяются пропорционально
5. Награды автоматически зачисляются на ваш баланс

---

## Казначейство

**Адрес:** `cpc1treasury000000000000000000000000000000000000000000`

**Источники финансирования:**
- 10% от всех комиссий за транзакции
- Предложения по управлению могут выделять средства

**Назначение:**
- Гранты для экосистемы
- Финансирование разработки
- Маркетинг и партнёрства
- Инициативы сообщества

**Управление:** Первоначально контролируется основной командой, с переходом к on-chain управлению.

---

## Экономические инварианты

Блокчейн обеспечивает строгие экономические инварианты:

### 1. Сохранение предложения

```
genesis_supply + total_minted - total_burned
= sum(account_balances) + sum(validator_stakes) + sum(delegations) + unbonding_queue + treasury
```

Проверяется после каждого блока.

### 2. Неотрицательные балансы

Все балансы аккаунтов должны быть ≥ 0 в любой момент времени.

### 3. Лимит мощности валидатора

Ни один валидатор не может контролировать >20% от общей voting power.

### 4. Согласованность делегирования

```
validator.total_delegated = sum(validator.delegations)
```

### 5. Точность распределения наград

```
distributed_rewards ≤ block_reward + fees
dust = (block_reward + fees) - distributed_rewards
dust → burned
```

---

## Система весов майнеров (Фаза 2A)

ComputeChain использует продвинутую **систему расчёта весов на основе ZK** для PoC воркеров:

### Формула веса

```
weight = results_count × gpu_tier × uptime_score × task_difficulty × reputation
```

**Компоненты:**

| Компонент | Диапазон | Описание |
|-----------|----------|----------|
| `results_count` | 0+ | Количество отправленных валидных результатов |
| `gpu_tier` | 0.5 - 4.5x | Множитель GPU (RTX 4080: 1.3x, H100: 4.0x, H200: 4.5x) |
| `uptime_score` | 0.0 - 1.0 | Показатель надёжности (выполнено / назначено задач) |
| `task_difficulty` | 1.0 - 6.0 | Множитель сложности задачи |
| `reputation` | 0.0 - 1.0 | Исторический показатель производительности |

### Множители уровней GPU

| GPU | Уровень | Описание |
|-----|---------|----------|
| RTX 4070 | 1.0x | Базовый потребительский GPU |
| RTX 4080 | 1.3x | +30% |
| RTX 4090 | 1.6x | +60% |
| RTX A6000 | 2.0x | Профессиональный GPU |
| A100 40GB | 2.5x | Дата-центр |
| A100 80GB | 3.0x | Высокая память |
| H100 | 4.0x | Последнее поколение |
| H200 | 4.5x | Высший уровень |

### Архитектура ZK доказательств

**Off-chain (Майнер):**
1. Вычислить вес по формуле
2. Сгенерировать ZK доказательство честного вычисления
3. Подписать (weight + proof) приватным ключом
4. Отправить в блокчейн

**On-chain (Блокчейн):**
1. Проверить подпись (аутентичность)
2. Проверить ZK доказательство (честное вычисление)
3. Проверить границы (мин/макс вес)
4. Распределить награды пропорционально

**Преимущества:**
- ✅ Сохранение приватности (спецификации GPU не раскрываются)
- ✅ Криптографическая безопасность (невозможно подделать вес)
- ✅ Быстрая верификация (нет выполнения формулы on-chain)
- ✅ Обновляемость (формула может меняться без хардфорка)

---

## Комиссии и экономика валидаторов

### Ставки комиссий

**Диапазон:** 0% - 20%

**Правила изменения:**
- **Время ожидания:** 7 дней между изменениями
- **Период объявления:** 4 часа до вступления в силу
- **Макс. увеличение:** +5 процентных пунктов за изменение

**Пример:**
```
День 0: Комиссия 5%
День 7: Объявление изменения до 10% → Вступает в силу через 4 часа
День 14: Можно изменить снова (время ожидания прошло)
```

**Защита делегаторов:**
Во время периода объявления делегаторы могут отозвать делегирование без штрафа (только 21-дневная разблокировка).

---

## Экономические параметры

Все экономические параметры централизованы в `protocol/config/economic_model.py`:

```python
DEVNET = EconomicConfig(
    initial_block_reward=10 * DECIMALS,
    halving_period_blocks=1_000_000,

    validator_reward_share=0.70,  # 70%
    miner_reward_share=0.30,      # 30%

    validator_fee_share=0.90,     # 90%
    treasury_fee_share=0.10,      # 10%

    max_validator_power_share=0.20,  # 20%
    max_commission_rate=0.20,        # 20%

    validator_slashing_rate=0.05,    # 5%
    miner_slashing_rate=0.10,        # 10%

    unjail_fee=1_000 * DECIMALS,     # 1000 CPC
    unstake_penalty_rate=0.10,       # 10%

    ...
)
```

**Сети:** DEVNET, TESTNET, MAINNET

---

## Резюме

**Экономическая модель ComputeChain:**

✅ **Устойчивая:** Эмиссия с халвингом и выборочное сжигание
✅ **Децентрализованная:** Лимит мощности 20%, макс. 10 валидаторов на делегатора
✅ **Безопасная:** Слешинг за нарушения, делегаторы тоже в зоне риска
✅ **Справедливая:** Веса майнеров на основе ZK, награды с учётом уровня GPU
✅ **Прозрачная:** Все параметры в одном конфигурационном файле
✅ **Проверяемая:** Экономические инварианты проверяются каждый блок

**Статус:**
- Фаза 1.2: Экономическая модель ✅ **ЗАВЕРШЕНА**
- Фаза 2A: Интеграция PoC ⏳ Готово к реализации

---

## Дополнительное чтение

- [Руководство по стейкингу](staking-guide.md) - Как стейкать и делегировать
- [Руководство валидатора](validator-guide.md) - Запуск ноды валидатора
- [API справочник](api-reference.md) - Запрос экономических метрик
- [Продвинутые темы](advanced.md) - Глубокое погружение в консенсус

---

**Последнее обновление:** 17 декабря 2025
**Версия экономической модели:** v2.0
**Реализация:** Фаза 1.2 завершена
